import{o as H,u as D}from"./chunk-XFMXKC7R.js";import{c as k,d as E,e as I,f as F,o as T}from"./chunk-ECQRDTG2.js";import{$a as S,Ca as u,Ga as P,N as y,Va as m,Wa as O,Xa as d,Za as h,_a as g,ab as n,bb as o,cb as f,kb as _,nb as r,ob as l,pb as x,s,va as v,w as b,wb as p,xa as a,xb as M,yb as w,zb as C}from"./chunk-G5SB7B44.js";var z=(t,e)=>e.purchaseId,U=(t,e)=>e.id;function j(t,e){t&1&&(n(0,"div",7)(1,"p"),r(2,"Cargando tu historial de compras..."),o()())}function A(t,e){if(t&1&&(n(0,"div",16),f(1,"img",19),n(2,"div",20)(3,"span",21),r(4),o(),n(5,"span",22),r(6),o(),n(7,"span",23),r(8),p(9,"currency"),o()()()),t&2){let i=e.$implicit;a(),S("src",i.imagenUrl||"https://placehold.co/50x50/FF5733/FFFFFF?text=Producto",v)("alt",i.nombre),a(3),l(i.nombre),a(2),x("x",i.cantidad),a(2),l(C(9,5,i.precio*i.cantidad,"UYU","$","1.2-2"))}}function B(t,e){if(t&1&&(n(0,"div",11)(1,"div",12)(2,"span",13),r(3),o(),n(4,"span",14),r(5),p(6,"date"),o()(),n(7,"div",15),h(8,A,10,10,"div",16,U),o(),n(10,"div",17)(11,"span"),r(12,"Total de la Compra:"),o(),n(13,"span",18),r(14),p(15,"currency"),o()()()),t&2){let i=e.$implicit;a(3),x("Compra ID: ",i.purchaseId.substring(0,8),"..."),a(2),l(w(6,3,i.timestamp,"short")),a(3),g(i.items),a(6),l(C(15,6,i.total,"UYU","$","1.2-2"))}}function L(t,e){if(t&1&&(n(0,"div",9),h(1,B,16,11,"div",11,z),o()),t&2){let i=_();a(),g(i)}}function N(t,e){t&1&&(n(0,"div",10)(1,"p"),r(2,"No tienes compras registradas a\xFAn."),o(),n(3,"a",24),r(4,"Explorar Men\xFA"),o()())}function q(t,e){t&1&&m(0,L,3,0,"div",9)(1,N,5,0,"div",10),t&2&&d(e.length>0?0:1)}function Y(t,e){t&1&&(n(0,"div",8)(1,"p"),r(2,"Ocurri\xF3 un error al cargar el historial de compras."),o()())}function R(t,e){if(t&1&&(m(0,q,2,1),p(1,"async"),O(2,Y,3,0,"div",8)),t&2){let i,c=_();d((i=M(1,1,c.purchases$))?0:2,i)}}var $=class t{constructor(e,i){this.authService=e;this.cartService=i;this.purchases$=s([])}purchases$;currentUserSubscription;userId=null;loading=!0;ngOnInit(){this.currentUserSubscription=this.authService.user$.pipe(y(e=>(this.userId=e?e.uid:null,this.userId?(this.loading=!0,this.cartService.getPurchaseHistory(this.userId)):(this.loading=!1,s([])))),b(e=>(this.loading=!1,console.log("Historial de compras cargado:",e),e.sort((i,c)=>new Date(c.timestamp).getTime()-new Date(i.timestamp).getTime())))).subscribe(e=>this.purchases$=s(e),e=>{console.error("Error al cargar el historial de compras:",e),this.loading=!1,this.purchases$=s([])})}ngOnDestroy(){this.currentUserSubscription&&this.currentUserSubscription.unsubscribe()}static \u0275fac=function(i){return new(i||t)(u(H),u(D))};static \u0275cmp=P({type:t,selectors:[["app-purchase-history"]],decls:11,vars:1,consts:[[1,"history-main-container"],[1,"history-content-wrapper"],[1,"back-button-container"],["routerLink","/cart",1,"back-button"],[1,"company-logo-container"],["src","https://placehold.co/150x50/FFDDC1/000000?text=Tu+Logo","alt","Logo de la Empresa",1,"company-logo"],[1,"history-title"],[1,"loading-message-history"],[1,"error-loading-history"],[1,"purchases-grid"],[1,"empty-history-message"],[1,"purchase-card"],[1,"purchase-header"],[1,"purchase-id"],[1,"purchase-date"],[1,"purchase-items-list"],[1,"purchase-item"],[1,"purchase-total"],[1,"total-amount"],[1,"purchase-item-image",3,"src","alt"],[1,"purchase-item-details"],[1,"purchase-item-name"],[1,"purchase-item-quantity"],[1,"purchase-item-price"],["routerLink","/",1,"back-to-menu-button"]],template:function(i,c){i&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),r(4,"\u2190 Volver al Carrito"),o()(),n(5,"div",4),f(6,"img",5),o(),n(7,"h1",6),r(8,"Historial de Compras"),o(),m(9,j,3,0,"div",7)(10,R,3,3),o()()),i&2&&(a(9),d(c.loading?9:10))},dependencies:[F,T,k,I,E],styles:[".history-main-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#1a202c;color:#e2e8f0;padding:2rem;font-family:sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:flex;flex-direction:column;align-items:center}.history-content-wrapper[_ngcontent-%COMP%]{max-width:800px;width:100%;margin:0 auto;background-color:#2d3748;border-radius:.5rem;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;overflow:hidden;padding:2rem;position:relative}.back-button-container[_ngcontent-%COMP%]{margin-bottom:1.5rem}.back-button[_ngcontent-%COMP%]{display:inline-block;background-color:#4a5568;color:#e2e8f0;padding:.75rem 1.5rem;border-radius:.5rem;text-decoration:none;font-weight:600;transition:background-color .3s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#64748b}.history-title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;text-align:center;margin-bottom:2rem;color:#f6e05e;font-family:Pacifico,cursive;text-shadow:2px 2px 4px rgba(0,0,0,.5)}.loading-message-history[_ngcontent-%COMP%], .empty-history-message[_ngcontent-%COMP%], .error-loading-history[_ngcontent-%COMP%]{text-align:center;padding:3rem;font-size:1.25rem;color:#a0aec0}.back-to-menu-button[_ngcontent-%COMP%]{display:inline-block;margin-top:1.5rem;background-color:#c53030;color:#fff;padding:.75rem 1.5rem;border-radius:.5rem;text-decoration:none;font-weight:600;transition:background-color .3s ease}.back-to-menu-button[_ngcontent-%COMP%]:hover{background-color:#a02020}.purchases-grid[_ngcontent-%COMP%]{display:grid;gap:2rem}.purchase-card[_ngcontent-%COMP%]{background-color:#1a202c;border-radius:.5rem;box-shadow:0 5px 15px #0003;padding:1.5rem;display:flex;flex-direction:column;gap:1rem}.purchase-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #4a5568;padding-bottom:.75rem;margin-bottom:.75rem}.purchase-id[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#a0aec0}.purchase-date[_ngcontent-%COMP%]{font-size:.9rem;color:#a0aec0}.purchase-items-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.purchase-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;background-color:#2d3748;padding:.75rem;border-radius:.375rem;box-shadow:inset 0 1px 3px #0000001a}.purchase-item-image[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:.25rem;object-fit:cover;flex-shrink:0}.purchase-item-details[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:.5rem}.purchase-item-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;color:#fff;flex-basis:100%}@media (min-width: 640px){.purchase-item-name[_ngcontent-%COMP%]{flex-basis:auto}}.purchase-item-quantity[_ngcontent-%COMP%]{font-size:.875rem;color:#a0aec0;margin-left:auto}.purchase-item-price[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#f6e05e;margin-left:.5rem}.purchase-total[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-top:1px solid #4a5568;padding-top:1rem;margin-top:1rem;font-size:1.25rem;font-weight:700;color:#fff}.purchase-total[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]{color:#f6e05e;font-size:1.5rem}"]})};export{$ as PurchaseHistoryComponent};
