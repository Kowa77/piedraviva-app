import{a as B}from"./chunk-DUTCJ627.js";import{h as R}from"./chunk-2XRK2AG4.js";import{o as $,u as N}from"./chunk-XFMXKC7R.js";import{c as q,e as V,f as j,l as A,o as U}from"./chunk-ECQRDTG2.js";import{$a as v,Ca as m,D as w,Ga as O,N as b,Va as g,Wa as k,Xa as _,Ya as S,Za as I,_a as D,aa as u,ab as r,ba as p,bb as o,cb as E,d as P,fb as z,jb as f,kb as c,nb as a,ob as s,s as C,tb as Q,va as M,w as y,wb as h,xa as d,xb as T,zb as F}from"./chunk-G5SB7B44.js";function Y(n,e){n&1&&(r(0,"div",4)(1,"p"),a(2,"Cargando detalles del producto..."),o()())}function H(n,e){if(n&1&&(r(0,"div",5)(1,"p"),a(2),o()()),n&2){let t=c();d(2),s(t.errorMessage)}}function G(n,e){if(n&1&&(r(0,"span",19),a(1),o()),n&2){let t=e.$implicit;d(),s(t)}}function J(n,e){if(n&1&&(r(0,"div",12),I(1,G,2,1,"span",19,S),o()),n&2){let t=c(2);d(),D(t.sabores)}}function K(n,e){if(n&1){let t=z();r(0,"div",6)(1,"div",7),E(2,"img",8),o(),r(3,"div",9)(4,"h2",10),a(5),o(),r(6,"p",11),a(7),o(),g(8,J,3,0,"div",12),r(9,"div",13)(10,"span",14),a(11),h(12,"currency"),o(),r(13,"div",15)(14,"button",16),f("click",function(){u(t);let l=c(3);return p(l.decrementQuantity())}),a(15,"-"),o(),r(16,"input",17),f("input",function(l){u(t);let x=c(3);return p(x.onQuantityInputChange(l))}),o(),r(17,"button",16),f("click",function(){u(t);let l=c(3);return p(l.incrementQuantity())}),a(18,"+"),o(),r(19,"button",18),f("click",function(){u(t);let l=c(),x=c(2);return p(x.addToCart(l))}),a(20,"Agregar al Carrito"),o()()()()()}if(n&2){let t=c(),i=c(2);d(2),v("alt",Q("Imagen de ",t.nombre))("src",t.imagenUrl||"https://placehold.co/600x400/FF5733/FFFFFF?text="+i.encodeURIComponent(t.nombre||"Producto"),M),d(3),s(t.nombre),d(2),s(t.descripcion),d(),_(i.isPizza(t)&&t.sabores.length?8:-1),d(3),s(F(12,8,t.precio,"UYU","$","1.2-2")),d(5),v("value",i.selectedQuantity)}}function W(n,e){n&1&&(r(0,"div",5)(1,"p"),a(2,"Producto no encontrado."),o()())}function X(n,e){n&1&&g(0,K,21,13,"div",6)(1,W,3,0,"div",5),n&2&&_(e?0:1)}function Z(n,e){n&1&&(r(0,"div",5)(1,"p"),a(2,"Producto no encontrado o error desconocido en el flujo de datos."),o()())}function tt(n,e){if(n&1&&(g(0,X,2,1),h(1,"async"),k(2,Z,3,0,"div",5)),n&2){let t,i=c();_((t=T(1,1,i.product$))?0:2,t)}}var L=class n{constructor(e,t,i,l){this.route=e;this.productService=t;this.cartService=i;this.authService=l;this.product$=C(void 0)}product$;loading=!0;errorMessage=null;selectedQuantity=0;userId=null;userSubscription;ngOnInit(){this.userSubscription=this.authService.user$.pipe(b(e=>(this.userId=e?e.uid:null,console.log("ProductDetailComponent: User ID after auth state change:",this.userId),this.route.paramMap)),b(e=>{let t=e.get("id");return t?(this.loading=!0,this.productService.getProductById(t).pipe(y(i=>(this.loading=!1,i&&(this.selectedQuantity=1),i)),w(i=>(console.error("Error al cargar los detalles del producto:",i),this.loading=!1,this.errorMessage="No se pudo cargar la informaci\xF3n del producto.",C(void 0))))):(this.loading=!1,this.errorMessage="ID de producto no proporcionado.",C(void 0))})).subscribe(e=>{console.log("ProductDetailComponent: Producto cargado:",e)},e=>{console.error("ProductDetailComponent: Error en la suscripci\xF3n principal:",e)})}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}incrementQuantity(){this.selectedQuantity++}decrementQuantity(){this.selectedQuantity>1&&this.selectedQuantity--}onQuantityInputChange(e){let t=e.target,i=parseInt(t.value,10);!isNaN(i)&&i>=0?this.selectedQuantity=i:(this.selectedQuantity=1,t.value="1")}addToCart(e){return P(this,null,function*(){if(!this.userId){alert("Debes iniciar sesi\xF3n para a\xF1adir productos al carrito.");return}if(this.selectedQuantity<=0){alert("Por favor, selecciona una cantidad mayor que 0 para a\xF1adir al carrito.");return}try{yield this.cartService.addItemToCart(this.userId,e,this.selectedQuantity),alert(`"${e.nombre}" x${this.selectedQuantity} a\xF1adido(s) al carrito.`),this.selectedQuantity=1}catch(t){console.error("Error al a\xF1adir al carrito:",t),alert("Ocurri\xF3 un error al a\xF1adir al carrito. Por favor, int\xE9ntalo de nuevo.")}})}isPizza(e){return e.tipo==="pizza"||e.sabores!==void 0}encodeURIComponent(e){return encodeURIComponent(e)}static \u0275fac=function(t){return new(t||n)(m(A),m(B),m(N),m($))};static \u0275cmp=O({type:n,selectors:[["app-product-detail"]],decls:8,vars:1,consts:[[1,"detail-main-container"],[1,"detail-content-wrapper"],[1,"back-button-container"],["routerLink","/",1,"back-button"],[1,"loading-message-detail"],[1,"not-found-message"],[1,"product-detail-card"],[1,"product-detail-image-container"],[1,"product-detail-image",3,"src","alt"],[1,"product-detail-info"],[1,"product-detail-name"],[1,"product-detail-description"],[1,"product-detail-flavors"],[1,"product-detail-price-section"],[1,"product-detail-price"],[1,"add-to-cart-controls"],[1,"quantity-button",3,"click"],["type","number","min","1",1,"quantity-input",3,"input","value"],[1,"add-button",3,"click"],[1,"product-flavor-tag-detail"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),a(4,"\u2190 Volver al Men\xFA"),o()(),g(5,Y,3,0,"div",4)(6,H,3,1,"div",5)(7,tt,3,3),o()()),t&2&&(d(5),_(i.loading?5:i.errorMessage?6:7))},dependencies:[j,U,R,q,V],styles:[".detail-main-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#1a202c;color:#e2e8f0;padding:2rem;font-family:sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:flex;flex-direction:column;align-items:center}.detail-content-wrapper[_ngcontent-%COMP%]{max-width:960px;width:100%;margin:0 auto;background-color:#2d3748;border-radius:.5rem;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;overflow:hidden;padding:2rem;position:relative}.back-button-container[_ngcontent-%COMP%]{margin-bottom:1.5rem}.back-button[_ngcontent-%COMP%]{display:inline-block;background-color:#4a5568;color:#e2e8f0;padding:.75rem 1.5rem;border-radius:.5rem;text-decoration:none;font-weight:600;transition:background-color .3s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#64748b}.product-detail-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}@media (min-width: 768px){.product-detail-card[_ngcontent-%COMP%]{flex-direction:row;align-items:flex-start}}.product-detail-image-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%;max-width:400px;border-radius:.5rem;overflow:hidden;box-shadow:0 10px 20px #0000004d}.product-detail-image[_ngcontent-%COMP%]{width:100%;height:auto;display:block}.product-detail-info[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column}.product-detail-name[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;color:#f6e05e;margin-bottom:1rem}.product-detail-description[_ngcontent-%COMP%]{font-size:1.125rem;color:#a0aec0;line-height:1.6;margin-bottom:1.5rem}.product-detail-flavors[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem;margin-bottom:2rem}.product-flavor-tag-detail[_ngcontent-%COMP%]{background-color:#e53e3e;color:#fff;font-size:.875rem;font-weight:600;padding:.5rem 1rem;border-radius:9999px;box-shadow:0 2px 4px #0003}.product-detail-price-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding-top:1.5rem;border-top:1px solid #4a5568;margin-top:auto}.product-detail-price[_ngcontent-%COMP%]{font-size:3rem;font-weight:800;color:#f6e05e}.add-to-cart-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.quantity-button[_ngcontent-%COMP%]{background-color:#4a5568;color:#fff;border:none;border-radius:.25rem;width:35px;height:35px;font-size:1.2rem;font-weight:700;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center}.quantity-button[_ngcontent-%COMP%]:hover{background-color:#64748b}.quantity-input[_ngcontent-%COMP%]{width:60px;padding:.5rem;border:1px solid #4a5568;border-radius:.375rem;background-color:#2d3748;color:#e2e8f0;font-size:1rem;text-align:center;-moz-appearance:textfield}.quantity-input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .quantity-input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.add-button[_ngcontent-%COMP%]{background-color:#f6e05e;color:#1a202c;padding:.6rem 1.2rem;border:none;border-radius:.5rem;font-size:.9rem;font-weight:700;cursor:pointer;transition:background-color .3s ease,transform .1s ease;box-shadow:0 2px 4px #0000001a}.add-button[_ngcontent-%COMP%]:hover{background-color:#ecc94b;transform:translateY(-1px)}.add-button[_ngcontent-%COMP%]:active{transform:translateY(0)}.loading-message-detail[_ngcontent-%COMP%], .not-found-message[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:300px;background-color:#2d3748;color:#a0aec0;font-size:1.25rem;border-radius:.5rem}@media (max-width: 768px){.detail-content-wrapper[_ngcontent-%COMP%]{padding:1rem}.product-detail-name[_ngcontent-%COMP%]{font-size:2rem}.product-detail-price[_ngcontent-%COMP%]{font-size:2.2rem}.product-detail-image-container[_ngcontent-%COMP%]{max-width:100%}.add-to-cart-controls[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center;width:100%}.quantity-button[_ngcontent-%COMP%], .quantity-input[_ngcontent-%COMP%], .add-button[_ngcontent-%COMP%]{flex-grow:1;max-width:unset}.add-button[_ngcontent-%COMP%]{margin-top:.5rem}}@media (max-width: 480px){.product-detail-name[_ngcontent-%COMP%], .product-detail-price[_ngcontent-%COMP%]{font-size:1.8rem}.product-detail-description[_ngcontent-%COMP%]{font-size:1rem}.product-flavor-tag-detail[_ngcontent-%COMP%]{font-size:.75rem;padding:.4rem .8rem}}"]})};export{L as ProductDetailComponent};
