import{a as $}from"./chunk-7Q3IIULG.js";import{h as V}from"./chunk-RMGGW7Y6.js";import{o as B,t as j}from"./chunk-NUYRC2UF.js";import{c as A,e as F,f as U,l as N,o as q}from"./chunk-ANXKTA7R.js";import{$a as k,Ab as R,D as M,Da as m,Ha as I,M as w,O as b,Q as P,Wa as g,Ya as C,Za as S,_a as E,ab as v,ba as u,bb as r,ca as p,cb as i,d as y,db as T,gb as D,kb as f,lb as l,ob as d,pb as s,s as _,ub as z,wa as O,xb as h,ya as a,yb as Q}from"./chunk-EQSQR36W.js";function H(o,e){if(o&1&&(r(0,"span",19),d(1),i()),o&2){let t=e.$implicit;a(),s(t)}}function Y(o,e){if(o&1&&(r(0,"div",12),E(1,H,2,1,"span",19,S),i()),o&2){let t=l(2);a(),k(t.sabores)}}function W(o,e){if(o&1){let t=D();r(0,"div",6)(1,"div",7),T(2,"img",8),i(),r(3,"div",9)(4,"h2",10),d(5),i(),r(6,"p",11),d(7),i(),g(8,Y,3,0,"div",12),r(9,"div",13)(10,"span",14),d(11),h(12,"currency"),i(),r(13,"div",15)(14,"button",16),f("click",function(){u(t);let c=l(2);return p(c.decrementQuantity())}),d(15,"-"),i(),r(16,"input",17),f("input",function(c){u(t);let x=l(2);return p(x.onQuantityInputChange(c))}),i(),r(17,"button",16),f("click",function(){u(t);let c=l(2);return p(c.incrementQuantity())}),d(18,"+"),i(),r(19,"button",18),f("click",function(){u(t);let c=l(),x=l();return p(x.addToCart(c))}),d(20,"Agregar al Carrito"),i()()()()()}if(o&2){let t=l(),n=l();a(2),v("alt",z("Imagen de ",t.nombre))("src",t.imagenUrl||"https://placehold.co/600x400/FF5733/FFFFFF?text="+n.encodeURIComponent(t.nombre||"Producto"),O),a(3),s(t.nombre),a(2),s(t.descripcion),a(),C(n.isPizza(t)&&t.sabores&&t.sabores.length?8:-1),a(3),s(R(12,8,t.precio,"UYU","$","1.2-2")),a(5),v("value",n.selectedQuantity)}}function G(o,e){o&1&&(r(0,"div",5)(1,"p"),d(2,"Producto no encontrado o error desconocido en el flujo de datos."),i()())}function J(o,e){if(o&1&&g(0,W,21,13,"div",6)(1,G,3,0,"div",5),o&2){let t=e,n=l();C(t&&!n.loading?0:!t&&!n.loading&&!n.errorMessage?1:-1)}}function K(o,e){o&1&&(r(0,"div",4)(1,"p"),d(2,"Cargando detalles del producto..."),i()())}function X(o,e){if(o&1&&(r(0,"div",5)(1,"p"),d(2),i()()),o&2){let t=l();a(2),s(t.errorMessage)}}var L=class o{constructor(e,t,n,c){this.route=e;this.productService=t;this.cartService=n;this.authService=c;this.product$=_(void 0)}product$;loading=!0;errorMessage=null;selectedQuantity=0;userId=null;ngOnInit(){console.log("NGONINIT: Inicializando ProductDetailComponent..."),this.product$=this.authService.user$.pipe(P(e=>{this.userId=e?e.uid:null,console.log("TAP (AuthService.user$): User ID despu\xE9s del cambio de estado de autenticaci\xF3n:",this.userId)}),b(()=>(console.log("SWITCHMAP (paramMap): Preparando para obtener par\xE1metros de ruta."),this.route.paramMap)),b(e=>{let t=e.get("id");return this.loading=!0,this.errorMessage=null,console.log("SWITCHMAP (params): ID de producto detectado:",t),console.log("SWITCHMAP (params): loading establecido a TRUE. errorMessage limpiado."),t?this.productService.getProductById(t).pipe(P(n=>{console.log("TAP (getProductById SUCCESS): Producto recibido del servicio:",n),this.loading=!1,console.log("TAP (getProductById SUCCESS): loading establecido a FALSE."),n?(this.selectedQuantity=1,console.log("TAP (getProductById SUCCESS): Cantidad seleccionada inicializada a 1.")):(this.errorMessage="Producto no encontrado. El ID podr\xEDa ser inv\xE1lido o el producto fue eliminado.",console.warn("TAP (getProductById SUCCESS): Producto no encontrado para ID:",t,"Estableciendo errorMessage."))}),M(n=>(console.error("CATCHERROR (getProductById ERROR): Error al cargar los detalles del producto:",n),this.loading=!1,this.errorMessage="No se pudo cargar la informaci\xF3n del producto. Error de red o servidor.",console.log("CATCHERROR (getProductById ERROR): loading establecido a FALSE. Estableciendo errorMessage."),_(void 0)))):(console.log("ELSE (paramMap): ID de producto no proporcionado. Finalizando carga."),this.loading=!1,this.errorMessage="ID de producto no proporcionado en la URL.",_(void 0))}),w(1))}ngOnDestroy(){console.log("NGONDESTROY: Destruyendo ProductDetailComponent.")}incrementQuantity(){this.selectedQuantity++,console.log("incrementQuantity: Cantidad actual:",this.selectedQuantity)}decrementQuantity(){this.selectedQuantity>1&&this.selectedQuantity--,console.log("decrementQuantity: Cantidad actual:",this.selectedQuantity)}onQuantityInputChange(e){let t=e.target,n=parseInt(t.value,10);console.log("onQuantityInputChange: Nueva cantidad ingresada:",n),!isNaN(n)&&n>=0?this.selectedQuantity=n:(this.selectedQuantity=1,t.value="1",console.warn("onQuantityInputChange: Cantidad inv\xE1lida, restableciendo a 1."))}addToCart(e){return y(this,null,function*(){if(console.log("addToCart: Intentando a\xF1adir al carrito el producto:",e),!this.userId){console.warn("addToCart: Debes iniciar sesi\xF3n para a\xF1adir productos al carrito.");return}if(this.selectedQuantity<=0){console.warn("addToCart: Por favor, selecciona una cantidad mayor que 0 para a\xF1adir al carrito.");return}try{yield this.cartService.addItemToCart(this.userId,e,this.selectedQuantity),console.log(`addToCart: "${e.nombre}" x${this.selectedQuantity} a\xF1adido(s) al carrito.`),this.selectedQuantity=1,console.log("addToCart: Cantidad seleccionada reiniciada a 1.")}catch(t){console.error("addToCart: Error al a\xF1adir al carrito:",t),this.errorMessage="Ocurri\xF3 un error al a\xF1adir al carrito. Por favor, int\xE9ntalo de nuevo."}})}isPizza(e){return e.tipo==="pizza"||e.sabores!==void 0}encodeURIComponent(e){return encodeURIComponent(e)}static \u0275fac=function(t){return new(t||o)(m(N),m($),m(j),m(B))};static \u0275cmp=I({type:o,selectors:[["app-product-detail"]],decls:9,vars:4,consts:[[1,"detail-main-container"],[1,"detail-content-wrapper"],[1,"back-button-container"],["routerLink","/",1,"back-button"],[1,"loading-message-detail"],[1,"not-found-message"],[1,"product-detail-card"],[1,"product-detail-image-container"],[1,"product-detail-image",3,"src","alt"],[1,"product-detail-info"],[1,"product-detail-name"],[1,"product-detail-description"],[1,"product-detail-flavors"],[1,"product-detail-price-section"],[1,"product-detail-price"],[1,"add-to-cart-controls"],[1,"quantity-button",3,"click"],["type","number","min","1",1,"quantity-input",3,"input","value"],[1,"add-button",3,"click"],[1,"product-flavor-tag-detail"]],template:function(t,n){if(t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),d(4,"\u2190 Volver al Men\xFA"),i()(),g(5,J,2,1),h(6,"async"),g(7,K,3,0,"div",4)(8,X,3,1,"div",5),i()()),t&2){let c;a(5),C((c=Q(6,2,n.product$))?5:-1,c),a(2),C(n.loading?7:n.errorMessage?8:-1)}},dependencies:[U,q,V,A,F],styles:[".detail-main-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#1a202c;color:#e2e8f0;padding:2rem;font-family:sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:flex;flex-direction:column;align-items:center}.detail-content-wrapper[_ngcontent-%COMP%]{max-width:960px;width:100%;margin:0 auto;background-color:#2d3748;border-radius:.5rem;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;overflow:hidden;padding:2rem;position:relative}.back-button-container[_ngcontent-%COMP%]{margin-bottom:1.5rem}.back-button[_ngcontent-%COMP%]{display:inline-block;background-color:#4a5568;color:#e2e8f0;padding:.75rem 1.5rem;border-radius:.5rem;text-decoration:none;font-weight:600;transition:background-color .3s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#64748b}.product-detail-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}@media (min-width: 768px){.product-detail-card[_ngcontent-%COMP%]{flex-direction:row;align-items:flex-start}}.product-detail-image-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%;max-width:400px;border-radius:.5rem;overflow:hidden;box-shadow:0 10px 20px #0000004d}.product-detail-image[_ngcontent-%COMP%]{width:100%;height:auto;display:block}.product-detail-info[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column}.product-detail-name[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;color:#f6e05e;margin-bottom:1rem}.product-detail-description[_ngcontent-%COMP%]{font-size:1.125rem;color:#a0aec0;line-height:1.6;margin-bottom:1.5rem}.product-detail-flavors[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem;margin-bottom:2rem}.product-flavor-tag-detail[_ngcontent-%COMP%]{background-color:#e53e3e;color:#fff;font-size:.875rem;font-weight:600;padding:.5rem 1rem;border-radius:9999px;box-shadow:0 2px 4px #0003}.product-detail-price-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding-top:1.5rem;border-top:1px solid #4a5568;margin-top:auto}.product-detail-price[_ngcontent-%COMP%]{font-size:3rem;font-weight:800;color:#f6e05e}.add-to-cart-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.quantity-button[_ngcontent-%COMP%]{background-color:#4a5568;color:#fff;border:none;border-radius:.25rem;width:35px;height:35px;font-size:1.2rem;font-weight:700;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center}.quantity-button[_ngcontent-%COMP%]:hover{background-color:#64748b}.quantity-input[_ngcontent-%COMP%]{width:60px;padding:.5rem;border:1px solid #4a5568;border-radius:.375rem;background-color:#2d3748;color:#e2e8f0;font-size:1rem;text-align:center;-moz-appearance:textfield}.quantity-input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .quantity-input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.add-button[_ngcontent-%COMP%]{background-color:#f6e05e;color:#1a202c;padding:.6rem 1.2rem;border:none;border-radius:.5rem;font-size:.9rem;font-weight:700;cursor:pointer;transition:background-color .3s ease,transform .1s ease;box-shadow:0 2px 4px #0000001a}.add-button[_ngcontent-%COMP%]:hover{background-color:#ecc94b;transform:translateY(-1px)}.add-button[_ngcontent-%COMP%]:active{transform:translateY(0)}.loading-message-detail[_ngcontent-%COMP%], .not-found-message[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:300px;background-color:#2d3748;color:#a0aec0;font-size:1.25rem;border-radius:.5rem}@media (max-width: 768px){.detail-content-wrapper[_ngcontent-%COMP%]{padding:1rem}.product-detail-name[_ngcontent-%COMP%]{font-size:2rem}.product-detail-price[_ngcontent-%COMP%]{font-size:2.2rem}.product-detail-image-container[_ngcontent-%COMP%]{max-width:100%}.add-to-cart-controls[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center;width:100%}.quantity-button[_ngcontent-%COMP%], .quantity-input[_ngcontent-%COMP%], .add-button[_ngcontent-%COMP%]{flex-grow:1;max-width:unset}.add-button[_ngcontent-%COMP%]{margin-top:.5rem}}@media (max-width: 480px){.product-detail-name[_ngcontent-%COMP%], .product-detail-price[_ngcontent-%COMP%]{font-size:1.8rem}.product-detail-description[_ngcontent-%COMP%]{font-size:1rem}.product-flavor-tag-detail[_ngcontent-%COMP%]{font-size:.75rem;padding:.4rem .8rem}}"]})};export{L as ProductDetailComponent};
