"use strict";(self.webpackChunkpiedraviva_app=self.webpackChunkpiedraviva_app||[]).push([[329],{1329:(j,u,r)=>{r.r(u),r.d(u,{ProductDetailComponent:()=>F});var _=r(467),l=r(2200),m=r(8132),s=r(7673),p=r(5558),g=r(6354),f=r(9437),C=r(4341),t=r(3664),d=r(2615),P=r(5921),h=r(6241),b=r(6868),v=r(4796);function x(o,a){1&o&&(t.j41(0,"div",4)(1,"p"),t.EFF(2,"Cargando detalles del producto..."),t.k0s()())}function M(o,a){if(1&o&&(t.j41(0,"div",5)(1,"p"),t.EFF(2),t.k0s()()),2&o){const n=t.XpG();t.R7$(2),t.JRh(n.errorMessage)}}function O(o,a){if(1&o&&(t.j41(0,"span",19),t.EFF(1),t.k0s()),2&o){const n=a.$implicit;t.R7$(),t.JRh(n)}}function E(o,a){if(1&o&&(t.j41(0,"div",12),t.Z7z(1,O,2,1,"span",19,t.Vm6),t.k0s()),2&o){const n=t.XpG(2);t.R7$(),t.Dyx(n.sabores)}}function y(o,a){if(1&o){const n=t.RV6();t.j41(0,"div",6)(1,"div",7),t.nrm(2,"img",8),t.k0s(),t.j41(3,"div",9)(4,"h2",10),t.EFF(5),t.k0s(),t.j41(6,"p",11),t.EFF(7),t.k0s(),t.nVh(8,E,3,0,"div",12),t.j41(9,"div",13)(10,"span",14),t.EFF(11),t.nI1(12,"currency"),t.k0s(),t.j41(13,"div",15)(14,"button",16),t.bIt("click",function(){d.eBV(n);const i=t.XpG(3);return d.Njj(i.decrementQuantity())}),t.EFF(15,"-"),t.k0s(),t.j41(16,"input",17),t.bIt("input",function(i){d.eBV(n);const c=t.XpG(3);return d.Njj(c.onQuantityInputChange(i))}),t.k0s(),t.j41(17,"button",16),t.bIt("click",function(){d.eBV(n);const i=t.XpG(3);return d.Njj(i.incrementQuantity())}),t.EFF(18,"+"),t.k0s(),t.j41(19,"button",18),t.bIt("click",function(){d.eBV(n);const i=t.XpG(),c=t.XpG(2);return d.Njj(c.addToCart(i))}),t.EFF(20,"Agregar al Carrito"),t.k0s()()()()()}if(2&o){const n=t.XpG(),e=t.XpG(2);t.R7$(2),t.Y8G("alt",t.VkB("Imagen de ",n.nombre))("src",n.imagenUrl||"https://placehold.co/600x400/FF5733/FFFFFF?text="+e.encodeURIComponent(n.nombre||"Producto"),t.B4B),t.R7$(3),t.JRh(n.nombre),t.R7$(2),t.JRh(n.descripcion),t.R7$(),t.vxM(e.isPizza(n)&&n.sabores.length?8:-1),t.R7$(3),t.JRh(t.ii3(12,8,n.precio,"UYU","$","1.2-2")),t.R7$(5),t.Y8G("value",e.selectedQuantity)}}function D(o,a){1&o&&(t.j41(0,"div",5)(1,"p"),t.EFF(2,"Producto no encontrado."),t.k0s()())}function k(o,a){1&o&&t.nVh(0,y,21,13,"div",6)(1,D,3,0,"div",5),2&o&&t.vxM(a?0:1)}function I(o,a){1&o&&(t.j41(0,"div",5)(1,"p"),t.EFF(2,"Producto no encontrado o error desconocido en el flujo de datos."),t.k0s()())}function T(o,a){if(1&o&&(t.nVh(0,k,2,1),t.nI1(1,"async"),t.vZN(2,I,3,0,"div",5)),2&o){let n;const e=t.XpG();t.vxM((n=t.bMT(1,1,e.product$))?0:2,n)}}let F=(()=>{class o{route;productService;cartService;authService;product$;loading=!0;errorMessage=null;selectedQuantity=0;userId=null;userSubscription;constructor(n,e,i,c){this.route=n,this.productService=e,this.cartService=i,this.authService=c,this.product$=(0,s.of)(void 0)}ngOnInit(){this.userSubscription=this.authService.user$.pipe((0,p.n)(n=>(this.userId=n?n.uid:null,console.log("ProductDetailComponent: User ID after auth state change:",this.userId),this.route.paramMap)),(0,p.n)(n=>{const e=n.get("id");return e?(this.loading=!0,this.productService.getProductById(e).pipe((0,g.T)(i=>(this.loading=!1,i&&(this.selectedQuantity=1),i)),(0,f.W)(i=>(console.error("Error al cargar los detalles del producto:",i),this.loading=!1,this.errorMessage="No se pudo cargar la informaci\xf3n del producto.",(0,s.of)(void 0))))):(this.loading=!1,this.errorMessage="ID de producto no proporcionado.",(0,s.of)(void 0))})).subscribe(n=>{console.log("ProductDetailComponent: Producto cargado:",n)},n=>{console.error("ProductDetailComponent: Error en la suscripci\xf3n principal:",n)})}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}incrementQuantity(){this.selectedQuantity++}decrementQuantity(){this.selectedQuantity>1&&this.selectedQuantity--}onQuantityInputChange(n){const e=n.target,i=parseInt(e.value,10);!isNaN(i)&&i>=0?this.selectedQuantity=i:(this.selectedQuantity=1,e.value="1")}addToCart(n){var e=this;return(0,_.A)(function*(){if(e.userId)if(e.selectedQuantity<=0)alert("Por favor, selecciona una cantidad mayor que 0 para a\xf1adir al carrito.");else try{yield e.cartService.addItemToCart(e.userId,n,e.selectedQuantity),alert(`"${n.nombre}" x${e.selectedQuantity} a\xf1adido(s) al carrito.`),e.selectedQuantity=1}catch(i){console.error("Error al a\xf1adir al carrito:",i),alert("Ocurri\xf3 un error al a\xf1adir al carrito. Por favor, int\xe9ntalo de nuevo.")}else alert("Debes iniciar sesi\xf3n para a\xf1adir productos al carrito.")})()}isPizza(n){return"pizza"===n.tipo||void 0!==n.sabores}encodeURIComponent(n){return encodeURIComponent(n)}static \u0275fac=function(e){return new(e||o)(t.rXU(P.nX),t.rXU(h.b),t.rXU(b.m),t.rXU(v.u))};static \u0275cmp=t.VBU({type:o,selectors:[["app-product-detail"]],decls:8,vars:1,consts:[[1,"detail-main-container"],[1,"detail-content-wrapper"],[1,"back-button-container"],["routerLink","/",1,"back-button"],[1,"loading-message-detail"],[1,"not-found-message"],[1,"product-detail-card"],[1,"product-detail-image-container"],[1,"product-detail-image",3,"src","alt"],[1,"product-detail-info"],[1,"product-detail-name"],[1,"product-detail-description"],[1,"product-detail-flavors"],[1,"product-detail-price-section"],[1,"product-detail-price"],[1,"add-to-cart-controls"],[1,"quantity-button",3,"click"],["type","number","min","1",1,"quantity-input",3,"input","value"],[1,"add-button",3,"click"],[1,"product-flavor-tag-detail"]],template:function(e,i){1&e&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),t.EFF(4,"\u2190 Volver al Men\xfa"),t.k0s()(),t.nVh(5,x,3,0,"div",4)(6,M,3,1,"div",5)(7,T,3,3),t.k0s()()),2&e&&(t.R7$(5),t.vxM(i.loading?5:i.errorMessage?6:7))},dependencies:[l.MD,m.Wk,C.YN,l.Jj,l.oe],styles:[".detail-main-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#1a202c;color:#e2e8f0;padding:2rem;font-family:sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:flex;flex-direction:column;align-items:center}.detail-content-wrapper[_ngcontent-%COMP%]{max-width:960px;width:100%;margin:0 auto;background-color:#2d3748;border-radius:.5rem;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;overflow:hidden;padding:2rem;position:relative}.back-button-container[_ngcontent-%COMP%]{margin-bottom:1.5rem}.back-button[_ngcontent-%COMP%]{display:inline-block;background-color:#4a5568;color:#e2e8f0;padding:.75rem 1.5rem;border-radius:.5rem;text-decoration:none;font-weight:600;transition:background-color .3s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#64748b}.product-detail-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}@media (min-width: 768px){.product-detail-card[_ngcontent-%COMP%]{flex-direction:row;align-items:flex-start}}.product-detail-image-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%;max-width:400px;border-radius:.5rem;overflow:hidden;box-shadow:0 10px 20px #0000004d}.product-detail-image[_ngcontent-%COMP%]{width:100%;height:auto;display:block}.product-detail-info[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column}.product-detail-name[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;color:#f6e05e;margin-bottom:1rem}.product-detail-description[_ngcontent-%COMP%]{font-size:1.125rem;color:#a0aec0;line-height:1.6;margin-bottom:1.5rem}.product-detail-flavors[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem;margin-bottom:2rem}.product-flavor-tag-detail[_ngcontent-%COMP%]{background-color:#e53e3e;color:#fff;font-size:.875rem;font-weight:600;padding:.5rem 1rem;border-radius:9999px;box-shadow:0 2px 4px #0003}.product-detail-price-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding-top:1.5rem;border-top:1px solid #4a5568;margin-top:auto}.product-detail-price[_ngcontent-%COMP%]{font-size:3rem;font-weight:800;color:#f6e05e}.add-to-cart-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.quantity-button[_ngcontent-%COMP%]{background-color:#4a5568;color:#fff;border:none;border-radius:.25rem;width:35px;height:35px;font-size:1.2rem;font-weight:700;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center}.quantity-button[_ngcontent-%COMP%]:hover{background-color:#64748b}.quantity-input[_ngcontent-%COMP%]{width:60px;padding:.5rem;border:1px solid #4a5568;border-radius:.375rem;background-color:#2d3748;color:#e2e8f0;font-size:1rem;text-align:center;-moz-appearance:textfield}.quantity-input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .quantity-input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.add-button[_ngcontent-%COMP%]{background-color:#f6e05e;color:#1a202c;padding:.6rem 1.2rem;border:none;border-radius:.5rem;font-size:.9rem;font-weight:700;cursor:pointer;transition:background-color .3s ease,transform .1s ease;box-shadow:0 2px 4px #0000001a}.add-button[_ngcontent-%COMP%]:hover{background-color:#ecc94b;transform:translateY(-1px)}.add-button[_ngcontent-%COMP%]:active{transform:translateY(0)}.loading-message-detail[_ngcontent-%COMP%], .not-found-message[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:300px;background-color:#2d3748;color:#a0aec0;font-size:1.25rem;border-radius:.5rem}@media (max-width: 768px){.detail-content-wrapper[_ngcontent-%COMP%]{padding:1rem}.product-detail-name[_ngcontent-%COMP%]{font-size:2rem}.product-detail-price[_ngcontent-%COMP%]{font-size:2.2rem}.product-detail-image-container[_ngcontent-%COMP%]{max-width:100%}.add-to-cart-controls[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center;width:100%}.quantity-button[_ngcontent-%COMP%], .quantity-input[_ngcontent-%COMP%], .add-button[_ngcontent-%COMP%]{flex-grow:1;max-width:unset}.add-button[_ngcontent-%COMP%]{margin-top:.5rem}}@media (max-width: 480px){.product-detail-name[_ngcontent-%COMP%], .product-detail-price[_ngcontent-%COMP%]{font-size:1.8rem}.product-detail-description[_ngcontent-%COMP%]{font-size:1rem}.product-flavor-tag-detail[_ngcontent-%COMP%]{font-size:.75rem;padding:.4rem .8rem}}"]})}return o})()}}]);